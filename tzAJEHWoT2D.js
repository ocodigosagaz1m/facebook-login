/*1354505873,173217837*/

if (self.CavalryLogger) { CavalryLogger.start_js(["rZ79y"]); }

__d("legacy:error-dialog",["ErrorDialog"],function(a,b,c,d){var e=b('ErrorDialog');a.ErrorDialog=e;},3);
__d("BanzaiODS",["Banzai"],function(a,b,c,d,e,f){var g=b('Banzai');function h(){var j={};function k(l,m,n,o){var p=j[l]||(j[l]={}),q=p[m]||(p[m]=[0]);if(n===undefined)n=1;if(o===undefined)o=1;n=Number(n);o=Number(o);if(!isFinite(n)||!isFinite(o))return;q[0]+=n;if(arguments.length>=4){if(!q[1])q[1]=0;q[1]+=o;}}return {bumpEntityKey:function(l,m,n){k(l,m,n);},bumpFraction:function(l,m,n,o){k(l,m,n,o);},flush:function(l){for(var m in j)g.post('ods:'+m,j[m]);j={};}};}var i=h();i.create=h;g.subscribe(g.SEND,i.flush);e.exports=i;});
__d("legacy:JSLogger",["JSLogger"],function(a,b,c,d){a.JSLogger=b('JSLogger');},3);
__d("MusicButtonStore",[],function(a,b,c,d,e,f){var g={},h={addButton:function(i,j){g[i]=j;return j;},getButton:function(i){return g[i];},getButtons:function(){return g;},removeButton:function(i){g[i]&&g[i].resetLoadingTimers();delete g[i];}};e.exports=h;});
__d("MusicEvents",["Arbiter"],function(a,b,c,d,e,f){var g=b('Arbiter');e.exports=a.MusicEvents=new g();});
__d("MusicProviders",[],function(a,b,c,d,e,f){e.exports=a.MusicProviders={SPOTIFY:'open.spotify.com'};});
__d("MusicConstants",["Arbiter","MusicEvents","MusicProviders"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('MusicEvents'),i=b('MusicProviders'),j={DEBUG:false,LIVE_LISTEN_MIN_SPOTIFY_VERSION:'spotify-0.6.6.0.g5a9eaca5',enableDebug:function(){this.DEBUG=true;},sameURLs:function(k,l){var m=/\/$/;if(k&&l){k=URI(k);l=URI(l);return k.getDomain()==l.getDomain()&&k.getPath()==l.getPath();}return false;},greaterOrEqualToMinimumVersion:function(k,l){var m=/(?:\d+\.)+/,n=k.match(m)[0].split('.').slice(0,-1),o=l.match(m)[0].split('.').slice(0,-1);if(n.length!==o.length)return false;for(var p=0;p<o.length;p++)if(+n[p]<+o[p]){return false;}else if(+n[p]>+o[p])return true;return true;},sanitizeForProviders:function(k){var l={};for(var m in k)if(this.ALLOWED_EXTERNAL_CONTEXT_PARAMS[m])l[m]=k[m];return l;},OP:{RESUME:'RESUME',PAUSE:'PAUSE',PLAY:'PLAY',VERSION:'VERSION'},STATUS_CHANGE_OP:{STATUS:'STATUS',LOGIN:'LOGIN',REINFORM:'REINFORM'},STATUS_CHANGE_EVENT:{playing:'PLAY_STATE_CHANGED',track:'TRACK_CHANGED'},DIAGNOSTIC_EVENT:{ALL_PAUSED:'ALL_PAUSED',ALL_OFFLINE:'ALL_OFFLINE',OFFLINE:'OFFLINE',ONLINE:'ONLINE',SEARCHING:'SEARCHING',HIT:'HIT',MISS:'MISS',RESIGN:'RESIGN',IFRAME_POLLING:'IFRAME_POLLING',RELAUNCH:'RELAUNCH',STATE_CHANGE:'STATE_CHANGE',WRONG_VERSION:'WRONG_VERSION',SERVICE_ERROR:'SERVICE_ERROR',INCORRECT_ONLINE_STATE:'INCORRECT_ONLINE_STATE',LOG_SEND_OP:'LOG_SEND_OP',REQUEUE_OP:'REQUEUE_OP'},ALLOWED_STATUS_PARAMS:{playing:'playing',track:'track',context:'context',client_version:'client_version',start_time:'start_time',expires_in:'expires_in',open_graph_state:'open_graph_state'},ALLOWED_EXTERNAL_CONTEXT_PARAMS:{uri:true,song:true,radio_station:true,album:true,playlist:true,musician:true,song_list:true,offset:true,title:true,request_id:true,listen_with_friends:true,needs_tos:true},LIVE_LISTEN_OP:{NOW_LEADING:'NOW_LEADING',NOW_LISTENING:'NOW_LISTENING',END_SESSION:'END_SESSION',SONG_PLAYING:'SONG_PLAYING',LISTENER_UPDATE:'LISTENER_UPDATE',QUEUE_SESSION:'QUEUE_SESSION',PLAY_ERROR:'PLAY_ERROR',SESSION_UPDATED:'SESSION_UPDATED',QUEUING_SESSION:'QUEUING_SESSION'},MUSIC_BUTTON:{ACTIVATE:'ACTIVATE'},ERROR:{1:'SERVICE_UNAVAILABLE_WITHOUT_PREMIUM',2:'SERVICE_UNAVAILABLE_WITHOUT_PREMIUM_OR_WAIT',3:'SERVICE_UNAVAILABLE_BILLING_ISSUE',4:'SERVICE_UNAVAILABLE_TECHNICAL_ISSUE',5:'AUDIO_AD_PLAYING',99:'SERVICE_TEMPORARILY_UNAVAILABLE',101:'SONG_UNAVAILABLE_WITHOUT_PURCHASE',102:'SONG_UNAVAILABLE_WITHOUT_PREMIUM',103:'SONG_UNAVAILABLE_INDEFINITELY'}};e.exports=a.MusicConstants||j;});
__d("MusicWaterfallLogger",["JSLogger"],function(a,b,c,d,e,f){var g=b('JSLogger'),h=g.create('music_waterfall'),i={click:function(l){j('click',l);},musicLoadedFromClick:function(l){j('music_loaded_from_click',l);},playPause:function(l){j('play_pause',l);}};function j(l,m){h.debug(l+'_debug',m);h.bump(l);h.bump(l+'_'+k(m));}function k(l){return l?l.replace(/\.|-/g,'_'):'';}e.exports=i;});
__d("MusicButton",["Bootloader","copyProperties","CSS","DOM","MusicButtonStore","MusicConstants","MusicEvents","MusicWaterfallLogger","Parent","Tooltip"],function(a,b,c,d,e,f){var g=b('Bootloader'),h=b('copyProperties'),i=b('CSS'),j=b('DOM'),k=b('MusicButtonStore'),l=b('MusicConstants'),m=b('MusicEvents'),n=b('MusicWaterfallLogger'),o=b('Parent'),p=b('Tooltip'),q=function(r,s,t,u,v,w){this.provider=r;this.buttonElem=s;this.url=t;this.context=u||{};this.mediaType=v;this.setState(this.STATES.OFFLINE);this.tooltip=w||'';m.subscribe(l.MUSIC_BUTTON.ACTIVATE,this.processClick.bind(this));};h(q,{tracksetableTypes:[]});h(q.prototype,{SHOW_LOADING_TIMEOUT:500,HIDE_LOADING_TIMEOUT:4000,RECENTLY_ONLINE_TIMEOUT:6000,STATES:{PLAYING:'music_playing',PAUSED:'music_paused',LOADING:'music_loading',DISABLED:'music_disabled',OFFLINE:'music_offline'},setState:function(r){if(r!==this.STATES.LOADING){this.resetLoadingTimers();this.previousState=this.state||r;}if(r===this.STATES.PLAYING){p.set(this.buttonElem,this.tooltip);}else p.set(this.buttonElem,'');var s=this.buttonElem.parentNode;this.state&&i.removeClass(s,this.state);this.state=r;i.addClass(s,this.state);},isTracksetable:function(r){return q.tracksetableTypes.indexOf(this.mediaType)!==-1;},handleIncomingEvent:function(r,s){clearTimeout(this._showLoadingTimer);if(s&&s.provider&&s.provider!=this.provider)return;switch(r){case l.DIAGNOSTIC_EVENT.ONLINE:case l.STATUS_CHANGE_EVENT.track:case l.STATUS_CHANGE_EVENT.playing:var t=s&&s.track&&s.track.uri,u=s&&s.context&&s.context.uri;if(s&&s.playing&&(l.sameURLs(t,this.url)||l.sameURLs(u,this.url))){this.setState(this.STATES.PLAYING);}else if(this.state===this.STATES.LOADING&&(this.previousState===this.STATES.PAUSED||this.previousState===this.STATES.OFFLINE)){clearTimeout(this._attemptingPlayTimer);this._attemptingPlayTimer=this.setState.bind(this,this.STATES.PAUSED).defer(this.RECENTLY_ONLINE_TIMEOUT,false);}else if(!this._attemptingPlayTimer)this.setState(this.STATES.PAUSED);break;case l.DIAGNOSTIC_EVENT.OFFLINE:this.setState(this.STATES.OFFLINE);break;case l.DIAGNOSTIC_EVENT.ALL_OFFLINE:this.setState(this.STATES.OFFLINE);break;}},processClick:function(r,s){if(s!=this.buttonElem){if(this.state===this.STATES.LOADING)this.previousState&&this.setState(this.previousState);return;}n.click(this.provider);var t=this.isTracksetable()&&o.byClass(this.buttonElem,'music_trackset_container'),u=[];if(t){var v=t.getAttribute('data-trackset-title'),w=this.provider,x=j.scry(t,'.music_button');for(var y=0;y<x.length;y++){var z=k.getButton([x[y].id]);if(z&&z.provider==w&&z.isTracksetable())u.push(z.url);}}if(!a.Music)this.showLoading(true);g.loadModules(['Music'],function(aa){n.musicLoadedFromClick(this.provider);var ba=(t&&u.length>1)?aa.playPauseSongList(this.provider,this.url,u,v,this.context):aa.playPauseSong(this.provider,this.url,this.context);this.showLoading(!ba);}.bind(this));},showLoading:function(r){this.resetLoadingTimers();this._hideLoadingTimer=this._timeout.bind(this,r).defer(this.HIDE_LOADING_TIMEOUT,false);this._showLoadingTimer=this.setState.bind(this,this.STATES.LOADING).defer(this.SHOW_LOADING_TIMEOUT,false);},resetLoadingTimers:function(){clearTimeout(this._hideLoadingTimer);clearTimeout(this._showLoadingTimer);clearTimeout(this._attemptingPlayTimer);this._attemptingPlayTimer=null;},destroy:function(){this.resetLoadingTimers();this.buttonElem=null;},_timeout:function(r){a.Music&&a.Music.reInform([this.provider]);if(!r&&this.state===this.STATES.LOADING)this.setState(this.STATES.PAUSED);}});e.exports=q;});
__d("MusicButtonManager",["event-extensions","DOM","KeyedCallbackManager","Layer","MusicButton","MusicButtonStore","MusicConstants","MusicEvents","Parent","$","copyProperties","ge"],function(a,b,c,d,e,f){b('event-extensions');var g=b('DOM'),h=b('KeyedCallbackManager'),i=b('Layer'),j=b('MusicButton'),k=b('MusicButtonStore'),l=b('MusicConstants'),m=b('MusicEvents'),n=b('Parent'),o=b('$'),p=b('copyProperties'),q=b('ge'),r=new h(),s=null,t={},u=0;function v(event){var ca=event.getTarget(),da=n.byClass(ca,'music_button');da=da||(!event.getModifiers().any&&w(ca));if(!da)return;return x(da,event);}function w(ca){var da=n.byClass(ca,'music_button_trigger')&&n.byClass(ca,'music_button_trigger_group');if(da){var ea=g.scry(da,'.music_button');if(ea.length)return ea[0];}return null;}function x(ca,event){event&&event.stop();m.inform(l.MUSIC_BUTTON.ACTIVATE,ca);return false;}function y(ca){a.Music&&a.Music.reInform(ca);}function z(ca,da){var ea=k.getButtons();for(var fa in ea)if(ea[fa].noGC||q(fa)){ea[fa].handleIncomingEvent(ca,da);}else k.removeButton(fa);}var aa={init:function(ca){if(s)return;s=true;j.tracksetableTypes=ca||[];Event.listen(document.body,'click',v);m.subscribe([l.STATUS_CHANGE_EVENT.playing,l.STATUS_CHANGE_EVENT.track,l.DIAGNOSTIC_EVENT.OFFLINE,l.DIAGNOSTIC_EVENT.ALL_OFFLINE,l.DIAGNOSTIC_EVENT.ONLINE],z);},add:function(ca,da,ea,fa,ga,ha){s||aa.init();var ia=da.id,ja=k.getButton(ia);if(ja)return ja;ja=k.addButton(ia,new j(ca,da,ea,p({button_id:ia},fa),ga,ha));var ka=n.byClass(da,'uiOverlay');if(ka){ja.noGC=true;var la=i.subscribe('destroy',function(ma,na){if(g.contains(na.getRoot(),da)){k.removeButton(ia);i.unsubscribe(la);}});}if(ca&&!t[ca])t[ca]=function(){var ma=Object.keys(t);ma.length&&y(ma);t={};}.defer();return ja;},addButton:function(ca,da,ea,fa,ga,ha){if(!q(da))return;var ia=o(da);return aa.add(ca,ia,ea,fa,ga,ha);},asyncAddMusicButton:function(ca,da){ca.setAttribute('id','music_button_'+u++);ba(ca,da);},tryAddButtonInDOM:function(ca,da){var ea=q(ca);ea&&ba(ea,da);},addMusicData:function(ca,da,ea,fa,ga,ha){r.setResource(ca,{provider:da,uri:ea,context:fa,media_type:ga,tooltip:ha});}};function ba(ca,da){var ea=g.find(ca,'a.button_anchor').getAttribute('href');r.executeOrEnqueue(ea,function(fa){return aa.add(fa.provider,ca,fa.uri,fa.context,fa.media_type,da?fa.tooltip:'');});}e.exports=a.MusicButtonManager||aa;});
__d("LiveMessageReceiver",["Arbiter","AsyncRequest","ChannelConstants","copyProperties","emptyFunction"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('ChannelConstants'),j=b('copyProperties'),k=b('emptyFunction');function l(m){this.eventName=m;this.subs=null;this.handler=k;this.shutdownHandler=null;this.registered=false;this.appId=1;}j(l,{getAppMessageType:function(m,n){return 'live_message/'+m+':'+n;},route:function(m){var n=function(o){var p=l.getAppMessageType(m.app_id,m.event_name);g.inform(p,o,g.BEHAVIOR_PERSISTENT);};if(m.hasCapture){new h().setHandler(function(o){n(o.getPayload());}).setAllowCrossPageTransition(true).handleResponse(m.response);}else n(m.response);}});j(l.prototype,{setAppId:function(m){this.appId=m;return this;},setHandler:function(m){this.handler=m;this._dirty();return this;},setRestartHandler:k,setShutdownHandler:function(m){this.shutdownHandler=m.shield();this._dirty();return this;},_dirty:function(){if(this.registered){this.unregister();this.register();}},register:function(){var m=function(o,p){return this.handler(p);}.bind(this),n=l.getAppMessageType(this.appId,this.eventName);this.subs={};this.subs.main=g.subscribe(n,m);if(this.shutdownHandler)this.subs.shut=g.subscribe(i.ON_SHUTDOWN,this.shutdownHandler);this.registered=true;return this;},unregister:function(){if(!this.subs)return this;for(var m in this.subs)if(this.subs[m])this.subs[m].unsubscribe();this.subs=null;this.registered=false;return this;}});e.exports=l;});
__d("legacy:livemessage",["LiveMessageReceiver"],function(a,b,c,d){a.LiveMessageReceiver=b('LiveMessageReceiver');},3);
__d("legacy:bind",["bind"],function(a,b,c,d){a.bind=b('bind');},3);
__d("legacy:fbdesktop-plugin",["FBDesktopPlugin"],function(a,b,c,d){a.FbDesktopPlugin=b('FBDesktopPlugin');},3);
function FriendBrowserCheckboxController(){}copyProperties(FriendBrowserCheckboxController,{instances:{},getInstance:function(a){return this.instances[a];}});copyProperties(FriendBrowserCheckboxController.prototype,{init:function(a,b){FriendBrowserCheckboxController.instances[a]=this;this._id=a;this._form=b;this._contentGrid=DOM.find(b,'.friendBrowserCheckboxContentGrid');this._loadingIndicator=DOM.find(b,'.friendBrowsingCheckboxContentLoadingIndicator');this._checkboxResults=DOM.find(b,'.friendBrowserCheckboxResults');this._contentPager=DOM.find(b,'.friendBrowserCheckboxContentPager');this.numGetNewRequests=0;this.queuedRequests={};},addTypeahead:function(a,b){a.subscribe('select',this.onHubSelect.bind(this,a,b));},onHubSelect:function(a,b,event,c){if(!((event=='select')&&c.selected))return;var d=this.buildNewCheckbox(b,c.selected.text,c.selected.uid),e=DOM.find(this._form,'.checkboxes_'+b);DOM.appendContent(e.firstChild,d);var f=DOM.scry(a.getElement(),'input[type="button"]');if(f&&f[0])f[0].click();this.getNew(true);},buildNewCheckbox:function(a,b,c){var d=a+'_ids_'+c,e=a+'_ids[]',f=DOM.create('input',{id:d,type:'checkbox',value:c,name:e,checked:true});Event.listen(f,'click',bind(this,'getNew',false));var g=DOM.create('td',null,f);CSS.addClass(g,'vTop');CSS.addClass(g,'hLeft');var h=DOM.create('label',null,b),i=DOM.create('td',null,h);CSS.addClass(i,'vMid');CSS.addClass(i,'hLeft');var j=DOM.create('tr');j.appendChild(g);j.appendChild(i);return j;},showMore:function(){var a=DOM.scry(this._contentPager,'.friendBrowserMorePager')[0];if(!a)return false;if(CSS.hasClass(a,'async_saving'))return false;var b=this.numGetNewRequests,c=Form.serialize(this._form);c.show_more=true;var d=new AsyncRequest().setURI('/ajax/growth/friend_browser/checkbox.php').setData(c).setHandler(bind(this,function(e){this.showMoreHandler(e,b);})).setStatusElement(a).send();},showMoreHandler:function(a,b){if(b==this.numGetNewRequests){var c=a.payload;DOM.appendContent(this._contentGrid,c.results);this.updatePagerAndExtraData(c.pager,c.extra_data);}},getNew:function(a){this.numGetNewRequests++;var b=this.numGetNewRequests;CSS.addClass(this._checkboxResults,'friendBrowserCheckboxContentOnload');if(ge('friendBrowserCI'))CSS.addClass($('friendBrowserCI'),'friendBrowserCheckboxContentOnload');CSS.show(this._loadingIndicator);var c=Form.serialize(this._form);c.used_typeahead=a;new AsyncRequest().setURI('/ajax/growth/friend_browser/checkbox.php').setData(c).setHandler(bind(this,function(d){this.getNewHandler(d,b);})).send();},getNewHandler:function(a,b){if(b==this.numGetNewRequests){var c=a.payload;DOM.setContent(this._contentGrid,c.results);CSS.removeClass(this._checkboxResults,'friendBrowserCheckboxContentOnload');if(ge('friendBrowserCI'))CSS.hide($('friendBrowserCI'));CSS.hide(this._loadingIndicator);this.updatePagerAndExtraData(c.pager,c.extra_data);}},updatePagerAndExtraData:function(a,b){DOM.setContent(this._contentPager,a);this.setupOnVisible();DOM.replace(this._form.elements.extra_data,b);},setupOnVisible:function(){var a=DOM.scry(this._contentPager,'.friendBrowserMorePager')[0];if(a&&this._id!='jewel'){this._onVisible&&this._onVisible.remove();this._onVisible=new OnVisible(a,bind(this,'showMore'),false,1000);}}});
__d("legacy:UserAction",["UserNoOp","userAction","reportData","clickRefAction"],function(a,b,c,d){a.UserNoOp=b('UserNoOp');a.user_action=b('userAction');a.report_data=b('reportData');a.click_ref_action=b('clickRefAction');},3);
__d("legacy:Poller",["Poller"],function(a,b,c,d){a.Poller=b('Poller');},3);
__d("legacy:user-activity",["UserActivity"],function(a,b,c,d){a.UserActivity=a.UserActivity||b('UserActivity');},3);
__d("legacy:BanzaiODS",["BanzaiODS"],function(a,b,c,d){a.BanzaiODS=b('BanzaiODS');},3);
__d("MercuryJewelCountControl",["Arbiter","MercuryConstants","DOM","JewelX","MercuryServerRequests","MercuryThreadInformer","MercuryUnseenState","copyProperties","tx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('MercuryConstants'),i=b('DOM'),j=b('JewelX'),k=b('MercuryServerRequests'),l=b('MercuryThreadInformer'),m=b('MercuryUnseenState'),n=b('copyProperties'),o=b('tx'),p,q,r,s=function(u){if(u||r.isOpen())m.markAsSeen();},t=function(u,v){p=u;q=i.find(p,'#mercurymessagesCountValue');r=v;this.render();k.subscribe('model-update-completed',function(w,x){s(false);});l.subscribe('unseen-updated',this.render.bind(this));r.subscribe('marked-seen',s.shield(this,true));};n(t.prototype,{render:function(){var u='';if(m.exceedsMaxCount()){u=o._("{count}+",{count:h.MercuryThreadlistConstants.MAX_UNSEEN_COUNT});}else u=m.getUnseenCount().toString();g.inform('jewel/count-updated',{jewel:'mercurymessages',count:u},g.BEHAVIOR_STATE);}});e.exports=t;});
__d("MercuryJewel",["MercuryChannelHandler","MercuryJewelCountControl","DOM","MercuryJewelThreadlistControl","MercuryServerRequests","userAction"],function(a,b,c,d,e,f){b('MercuryChannelHandler');var g=b('MercuryJewelCountControl'),h=b('DOM'),i=b('MercuryJewelThreadlistControl'),j=b('MercuryServerRequests'),k=b('userAction'),l=false;function m(q,r,s,t){j.handleUpdate(t);var u=new g(r,s),v=h.find(q,'#MercuryJewelThreadList');if(s.getRoot()&&s.isOpen()){n.call(this,v);}else s.subscribe('opened',n.bind(this,v));}e.exports=m;function n(q){this._ua=k('messages').uai('click','jewel');this._listenForLoad=this._listenForRender=true;if(!l){var r=new i(q);r.subscribe(i.EVENT_THREADS_LOADED,o.bind(this));r.subscribe(i.EVENT_THREADS_RENDERED,p.bind(this));l=true;}}function o(){if(this._listenForLoad){this._ua.add_event('loaded');this._listenForLoad=false;}}function p(){if(this._listenForRender){this._ua.add_event('rendered');this._listenForRender=false;}}});
__d("MessagingEvents",["array-extensions","Arbiter","ChannelConstants","copyProperties","isEmpty"],function(a,b,c,d,e,f){b('array-extensions');var g=b('Arbiter'),h=b('ChannelConstants'),i=b('copyProperties'),j=b('isEmpty'),k={},l=new g();function m(n){if(!j(k))return;for(var o in n)l.inform('count/'+o,n[o]);}l.subscribe('mark-as-read',function(n,o){(o.tids||o.chat_ids||[]).forEach(function(p){p=''+p;if(!(p in k)){k[p]=true;var q=function(){l.unsubscribe(r);clearTimeout(s);delete k[p];},r=l.subscribe('read',function(t,u){if((u.tids||[]).contains(p)||(u.chat_ids||[]).contains(p))q();}),s=q.defer(60000);}});});g.subscribe(h.getArbiterType('messaging'),function(n,o){var p=i({},o.obj),event=p.event||'';delete p.type;delete p.event;l.inform(event,p);if('unread_counts' in p){var q=p.unread_counts;m({unread:q.inbox,other_unseen:q.other});}});g.subscribe(h.getArbiterType('inbox'),function(n,o){var p=i(o.obj);delete p.type;m(p);});a.MessagingEvents=e.exports=l;},3);
__d("AccessibleMenu",["event-extensions","CSS","DOM","Keys","TabbableElements","Toggler"],function(a,b,c,d,e,f){b('event-extensions');var g=b('CSS'),h=b('DOM'),i=b('Keys'),j=b('TabbableElements'),k=b('Toggler'),l,m,n;function o(){var w=h.scry(l,'a[rel="toggle"]')[0];w&&w.focus();k.getInstance(l).hide();}function p(w){if(!w)return false;g.removeClass(w,'selected');w.setAttribute('aria-selected','false');}function q(w){if(!w)return false;g.addClass(w,'selected');w.setAttribute('aria-selected','true');var x=j.find(w);if(x[0])x[0].focus();}function r(w){var x=h.scry(l,'.selected')[0],y=m.indexOf(x)+w,z=m[y];if(!z)return false;p(x);q(z);}function s(w){if(!k.isShown()||k.getActive()!==l)return true;var x=Event.getKeyCode(w);switch(x){case i.TAB:r(w.shiftKey?-1:1);Event.prevent(w);break;case i.ESC:o();Event.prevent(w);break;case i.UP:case i.DOWN:r(x===i.UP?-1:1);Event.prevent(w);break;}}function t(w,x){l=x.getActive();m=h.scry(l,'[role="menuitem"]');if(!n)n=Event.listen(document.documentElement,'keydown',s);}function u(){if(k.getActive()==l)p(h.scry(l,'.selected')[0]);}var v={init:function(w){k.listen('show',w,t);k.listen('hide',w,u);}};e.exports=v;});
__d("QuicklingAugmenter",["URI"],function(a,b,c,d,e,f){var g=b('URI'),h=[],i={addHandler:function(j){h.push(j);},augmentURI:function(j){var k=[],l=g(j);h.forEach(function(m){var n=m(l);if(!n)return;k.push(m);l=l.addQueryData(n);});h=k;return l;}};e.exports=i;});
__d("Quickling",["AjaxPipeRequest","Arbiter","Class","DocumentTitle","DOM","ErrorUtils","HTML","OnloadHooks","PageTransitions","QuicklingAugmenter","Run","URI","UserAgent","copyProperties","goOrReplace","isEmpty","QuicklingConfig"],function(a,b,c,d,e,f){var g=b('AjaxPipeRequest'),h=b('Arbiter'),i=b('Class'),j=b('DocumentTitle'),k=b('DOM'),l=b('ErrorUtils'),m=b('HTML'),n=b('OnloadHooks'),o=b('PageTransitions'),p=b('QuicklingAugmenter'),q=b('Run'),r=b('URI'),s=b('UserAgent'),t=b('copyProperties'),u=b('goOrReplace'),v=b('isEmpty'),w=c('QuicklingConfig'),x=w.version,y=w.sessionLength,z=new RegExp(w.inactivePageRegex),aa=0,ba,ca='',da={isActive:function(){return true;},isPageActive:function(ka){if(ka=='#')return false;ka=new r(ka);if(ka.getDomain()&&ka.getDomain()!=r().getDomain())return false;if(ka.getPath()=='/l.php'){var la=ka.getQueryData().u;if(la){la=r(unescape(la)).getDomain();if(la&&la!=r().getDomain())return false;}}var ma=ka.getPath(),na=ka.getQueryData();if(!v(na))ma+='?'+r.implodeQuery(na);return !z.test(ma);}};function ea(ka){ka=ka||'Facebook';j.set(ka);if(s.ie()){ca=ka;if(!ba)ba=window.setInterval(function(){var la=ca,ma=j.get();if(la!=ma)j.set(la);},5000,false);}}function fa(ka){var la=document.getElementsByTagName('link');for(var ma=0;ma<la.length;++ma){if(la[ma].rel!='alternate')continue;k.remove(la[ma]);}if(ka.length){var na=k.find(document,'head');na&&k.appendContent(na,m(ka[0]));}}function ga(ka){var la={version:x};this.parent.construct(this,ka,{quickling:la});}i.extend(ga,g);t(ga.prototype,{_preBootloadFirstResponse:function(ka){return true;},_fireDomContentCallback:function(){this._request.cavalry&&this._request.cavalry.setTimeStamp('t_domcontent');o.transitionComplete();this._onPageDisplayed&&this._onPageDisplayed(this.pipe);this.parent._fireDomContentCallback();},_fireOnloadCallback:function(){if(this._request.cavalry){this._request.cavalry.setTimeStamp('t_hooks');this._request.cavalry.setTimeStamp('t_layout');this._request.cavalry.setTimeStamp('t_onload');}this.parent._fireOnloadCallback();},isPageActive:function(ka){return da.isPageActive(ka);},_versionCheck:function(ka){if(ka.version==x)return true;var la=['quickling','ajaxpipe','ajaxpipe_token'];u(window.location,r(ka.uri).removeQueryData(la),true);return false;},_processFirstResponse:function(ka){var la=ka.getPayload();ea(la.title);fa(la.syndication||[]);window.scrollTo(0,0);var ma=la.body_class||'';document.body.className=ma;},getSanitizedParameters:function(){return ['quickling'];}});function ha(){aa++;return aa>=y;}function ia(ka){g.setCurrentRequest(null);if(ha())return false;ka=p.augmentURI(ka);if(!da.isPageActive(ka))return false;window.ExitTime=Date.now();q.__removeHook('onafterloadhooks');q.__removeHook('onloadhooks');n.runHooks('onleavehooks');h.inform('onload/exit',true);new ga(ka).setCanvasId('content').send();return true;}function ja(ka){var la=window[ka];function ma(na,oa,pa){if(typeof na!=='function')na=eval.bind(null,na);var qa=la(l.guard(na),oa);if(oa>0)if(pa!==false)q.onLeave(function(){clearInterval(qa);});return qa;}window[ka]=ma;}q.onAfterLoad(function ka(){ja('setInterval');ja('setTimeout');o.registerHandler(ia,1);});e.exports=a.Quickling=da;});
__d("StringTransformations",[],function(a,b,c,d,e,f){e.exports={unicodeEscape:function(g){return g.replace(/[^A-Za-z0-9\-\.\:\_\$\/\+\=]/g,function(h){var i=h.charCodeAt().toString(16);return '\\u'+('0000'+i.toUpperCase()).slice(-4);});},unicodeUnescape:function(g){return g.replace(/(\\u[0-9A-Fa-f]{4})/g,function(h){return String.fromCharCode(parseInt(h.slice(2),16));});}};});
__d("NotificationCounter",["Arbiter","DocumentTitle","JSLogger"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('DocumentTitle'),i=b('JSLogger'),j={messages:0,notifications:0,requests:0},k={init:function(){g.subscribe('update_title',this._handleUpdate.bind(this));g.subscribe('jewel/count-updated',this._handleCountUpdate.bind(this));},getCount:function(){var l=0;for(var m in j){var n=Number(j[m]);if(typeof j[m]=='string'&&isNaN(n))return j[m];if(isNaN(n)||n<0){i.create('jewels').error('bad_count',{jewel:m,count:j[m]});continue;}l+=n;}return l;},updateTitle:function(){var l=this.getCount(),m=h.get();m=l?'('+l+') '+m:m;h.set(m,true);},_handleCountUpdate:function(l,m){j[m.jewel]=m.count;this.updateTitle();},_handleUpdate:function(l,m){this.updateTitle();}};e.exports=k;});
__d("legacy:notif-xlist",["NotifXList"],function(a,b,c,d){a.NotifXList=b('NotifXList');},3);
__d("legacy:notifications-list",["NotificationList"],function(a,b,c,d){a.NotificationList=b('NotificationList');},3);
__d("PagesVoiceBar",["$","Arbiter","AsyncRequest","CSS","ChannelConstants","DOM","PageTransitions"],function(a,b,c,d,e,f){var g=b('$'),h=b('Arbiter'),i=b('AsyncRequest'),j=b('CSS'),k=b('ChannelConstants'),l=b('DOM'),m=b('PageTransitions'),n='PagesVoiceBar/toggle',o='PagesVoiceBar/initialized',p='PagesVoiceBar/switchVoice',q='page_transition',r='pages_voice_bar_sync',s=null,t=null,u=false,v=false;function w(){v=!v;j.conditionClass(document.body,'hasVoiceBar',v);}function x(da,ea){new i('/ajax/pages/switch_voice.php').setData(ea).setHandler(function(fa){ba();}).send();}function y(){s=null;}function z(da,ea){if(ea.obj.profile_id&&ea.obj.profile_id==s)ba();}function aa(da){h.subscribe(o,da);}function ba(){m.getNextURI().go();}var ca={initVoiceBar:function(){if(u)return;t=g('pagesVoiceBarContent');v=j.hasClass(document.body,'hasVoiceBar');h.subscribe(n,w);h.subscribe(p,x);h.subscribe(q,y);h.subscribe(k.getArbiterType(r),z);u=true;h.inform(o,null,h.BEHAVIOR_STATE);},update:function(da,ea){aa(function(){s=ea;l.setContent(t,da);});}};e.exports=ca;});
__d("legacy:SearchSponsoredTypeaheadBehavior",["TypeaheadSearchSponsored"],function(a,b,c,d){var e=b('TypeaheadSearchSponsored');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.searchSponsored=function(f){f.enableBehavior(e);};},3);
__d("legacy:SearchDataSource",["SearchDataSource"],function(a,b,c,d){a.SearchDataSource=b('SearchDataSource');},3);
__d("SearchTypeaheadCore",["event-extensions","function-extensions","Arbiter","Class","DOM","Input","Parent","TypeaheadCore","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('Arbiter'),h=b('Class'),i=b('DOM'),j=b('Input'),k=b('Parent'),l=b('TypeaheadCore'),m=b('copyProperties');function n(o){this.parent.construct(this,o);}h.extend(n,l);m(n.prototype,{init:function(o,p,q){this.parent.init(o,p,q);var r=k.byTag(q,'form'),s=this.reset.bind(this);g.subscribe('pre_page_transition',function(event,u){var v=/^\/search/,w=v.test(u.from.path),x=v.test(u.to.path);if(w&&!x)s.defer();});if(r){var t=i.find(r,'input.search_sid_input');Event.listen(r,'submit',function(){if(this.data&&this.data.queryData)t.value=this.data.queryData.sid;s.defer();}.bind(this),Event.Priority.URGENT);}},select:function(){this.reset();this.element.focus();(function(){this.element.blur();}).bind(this).defer();},handleTab:function(event){var o=this.view.getQuerySuggestion(this.value);if(o){j.setValue(this.element,o);this.checkValue();event.kill();}else this.parent.handleTab(event);}});e.exports=n;});
__d("legacy:SearchTypeaheadCore",["SearchTypeaheadCore"],function(a,b,c,d){a.SearchTypeaheadCore=b('SearchTypeaheadCore');},3);
__d("legacy:SearchTypeaheadView",["SearchTypeaheadView"],function(a,b,c,d){a.SearchTypeaheadView=b('SearchTypeaheadView');},3);
__d("legacy:Typeahead",["Typeahead"],function(a,b,c,d){a.Typeahead=b('Typeahead');},3);
__d("SearchTypeaheadRenderer",["DOM","Env","MusicButtonManager","TypeaheadUtil"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('Env'),i=b('MusicButtonManager'),j=b('TypeaheadUtil');function k(l,m){var n=[];if(l.photo){n.push(g.create('img',{className:'photo',alt:'',src:l.photo}));if(l.song){n.push(g.create('span',{className:'playButton'}));n.push(g.create('span',{className:'playLoader'}));}}if(l.text&&l.type=='websuggestion'&&l.photo){n.push(g.create('span',{className:'shiftedtext'},[l.text]));}else if(l.text){var o=l.alias,p=this.value,q=l.text,r=[q];if(o&&j.isQueryMatch(p,o)&&!j.isQueryMatch(p,q))r.push(g.create('span',{className:'alias'},[' \xB7 '+o]));n.push(g.create('span',{className:'text'},r));}if(l.category){var s=[l.category];if(l.is_external)s.push(g.create('span',{className:'arrow'}));var t=l.message?'preCategory':'category';n.push(g.create('span',{className:t},s));}if(l.message)n.push(g.create('span',{className:'category'},[l.message]));var u=l.subtextOverride||l.subtext;if(u)n.push(g.create('span',{className:'subtext'},[u]));var v=l.classNames||l.type||'',w=l.is_external?'_blank':'',x=!l.song&&l.path||'';if(x){if(!(/^https?\:\/\//).test(x))x=h.www_base+x.substr(1);x+=(x.indexOf('?')>0?'&':'?')+'ref=ts&fref=ts';}var y=g.create('a',{href:x,rel:'ignore',target:w},n);if(l.song){y.id='mb_'+(Math.random()*1e+06|0);i.addButton.curry(l.song.provider,y.id,l.song.url,l.song.context,l.song.media_type).defer();y.onclick=this.ignoreClick;}var z=g.create('li',{className:v},[y]);if(l.text)z.setAttribute('aria-label',l.text);return z;}k.className='search';e.exports=k;});
__d("legacy:SearchTypeaheadRenderer",["SearchTypeaheadRenderer"],function(a,b,c,d){if(!a.TypeaheadRenderers)a.TypeaheadRenderers={};a.TypeaheadRenderers.search=b('SearchTypeaheadRenderer');},3);
__d("TypeaheadRegulateMemorializedUsers",["copyProperties","TypeaheadUtil"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=b('TypeaheadUtil');function i(j){this._typeahead=j;}g(i.prototype,{_filterRegistry:null,_filter:function(j,k){if(j.type!=='user'||!j.memorialized)return true;var l=h.parse(j.text).tokens;if(l.length===1&&h.isExactMatch(k,j.text))return true;var m=this._typeahead.getData().getTextToIndex(j),n=h.parse(k).tokens;return (n.length>1&&h.isQueryMatch(k,m));},enable:function(){this._filterRegistry=this._typeahead.getData().addFilter(this._filter.bind(this));},disable:function(){this._filterRegistry.remove();this._filterRegistry=null;}});e.exports=i;});
__d("legacy:RegulateMemorializedUsersTypeaheadBehavior",["TypeaheadRegulateMemorializedUsers"],function(a,b,c,d){var e=b('TypeaheadRegulateMemorializedUsers');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.regulateMemorializedUsers=function(f){f.enableBehavior(e);};},3);
__d("WebStorageMonster",["event-extensions","AsyncRequest","UserActivity","StringTransformations","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f){b('event-extensions');var g=b('AsyncRequest'),h=b('UserActivity'),i=b('StringTransformations'),j=b('setTimeoutAcrossTransitions'),k=300000,l=false;function m(r){var s={};for(var t in r){var u=r.getItem(t),v=i.unicodeEscape(t);if(typeof u==='string')s[v]=u.length;}return s;}function n(r){if(a.localStorage&&r.keys)q._getLocalStorageKeys().forEach(function(s){if(r.keys.contains(s))a.localStorage.removeItem(s);});}function o(r){if(a.localStorage)q._getLocalStorageKeys().forEach(function(s){if(!r.some(function(t){return new RegExp(t).test(s);}))a.localStorage.removeItem(s);});if(a.sessionStorage)a.sessionStorage.clear();}function p(r){if(h.isActive(k)){j(p.curry(r),k);}else q.cleanNow(r);}var q={registerLogoutForm:function(r,s){Event.listen(r,'submit',function(t){q.cleanOnLogout(s);});},schedule:function(r){if(l)return;l=true;p(r);},cleanNow:function(r){var s=Date.now(),t={},u=false;['localStorage','sessionStorage'].forEach(function(w){if(a[w]){t[w]=m(a[w]);u=true;}});var v=Date.now();t.logtime=v-s;if(u)new g('/ajax/webstorage/process_keys.php').setData(t).setHandler(function(w){if(!r){var x=w.getPayload();if(x.keys)x.keys=x.keys.map(i.unicodeUnescape);n(x);}}.bind(this)).send();},cleanOnLogout:function(r){if(r)o(r);if(a.sessionStorage)a.sessionStorage.clear();},_getLocalStorageKeys:Object.keys.curry(a.localStorage)};e.exports=q;});